<div class="tree overlay-panel mat-elevation-z4" *ngIf="treeOpen$ | async">
  <tailormap-dialog-close-button (closeDialog)="closeTree()" icon="chevron_left"></tailormap-dialog-close-button>
  <h1>Objectrelaties</h1>
  <tailormap-form-tree [isBulk]="isBulk" [feature]="feature"></tailormap-form-tree>
</div>

<div *ngIf="isOpenTreeClosed$ | async" class="overlay-panel-toggle mat-elevation-z2" (click)="openTree()">
  <mat-icon svgIcon="contextual_chevron_left"></mat-icon>
</div>

<div *ngIf="isOpen$ | async" class="overlay-panel mat-elevation-z4">
  <tailormap-dialog-close-button (closeDialog)="closeForm()"></tailormap-dialog-close-button>
  <h1>{{formConfig.name}} {{formDirty ? '*' : ''}}</h1>
  <div class="form-container">
    <div class="form">
      <tailormap-form-creator #formCreator
                             [feature]="feature"
                             [features]="features"
                             [formConfig]="formConfig"
                             [isBulk]="isBulk"
                             (formChanged)="formChanged($event)"></tailormap-form-creator>
    </div>
  </div>
  <div class="bottom-bar">

    <button mat-flat-button color="accent" (click)="formCreator.resetForm()" *ngIf="formCreator.editing$ | async">
      Annuleren
    </button>

    <mat-menu #menu="matMenu">
      <button *ngFor="let co of formsForNew" [id]="co.featureType" mat-menu-item (click)="newItem($event, co.featureType);">
        {{co.name}}
      </button>
    </mat-menu>

    <mat-menu #optiesMenu="matMenu" yPosition="above" class="tailormap-menu-panel">
      <button mat-menu-item [matMenuTriggerFor]="menu">Object toevoegen</button>
      <button mat-menu-item (click)="copy();">Paspoort gegevens kopiÃ«ren</button>
      <button mat-menu-item (click)="editGeometry();">Bewerk geometrie</button>
      <button mat-menu-item class="red-item"  (click)="remove();"><mat-icon color="warn">delete_forever</mat-icon>Verwijderen</button>
    </mat-menu>

    <button mat-flat-button color="accent" [matMenuTriggerFor]="optiesMenu" *ngIf="(formCreator.editing$ | async) === false">
      Opties
    </button>

    <div class="button-separator"></div>

    <button mat-flat-button *ngIf="(formCreator.editing$ | async) === false" color="primary" (click)="setFormEditing(true)">
      Bewerken
    </button>

    <button *ngIf="formCreator.editing$ | async"
            [disabled]="!formDirty && !closeAfterSave"
            mat-flat-button
            color="primary"
            (click)="formCreator.beforeSave();">
      <span *ngIf="!closeAfterSave">Opslaan</span>
      <span *ngIf="isMultiFormWorkflow$ | async; else saveLabel">Volgende</span>
    </button>

  </div>
</div>

<ng-template #saveLabel><span>Opslaan</span></ng-template>
